---
layout: post
title: SQL
date: 2021-03-28 11:18 +0800
tags: [Programming]
toc:  true
---

<!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TG0XJZG53F"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-TG0XJZG53F');
  </script>

  <style TYPE="text/css">code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}</style><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [['$','$'], ['\\(','\\)']],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
      }});
  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i = 0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }});
  </script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>  


**CITY**

Field|Type
:--|:--
ID|NUMBER
NAME|VARCHAR2(17)
COUNTRYCODE|VARCHAR2(3)
DISTRICT|VARCHAR2(20)
POPULATION|NUMBER



1 Revising the Select Query I

Query all columns for all American cities in the CITY table with populations larger than 100000. The CountryCode for America is USA.

```SQL
SELECT *
FROM CITY
WHERE CountryCode ='USA'
AND Population>100000;
```
```HTML
3878 Scottsdale USA Arizona 202705
3965 Corona USA California 124966
3973 Concord USA California 121780
3977 Cedar Rapids USA Iowa 120758
3982 Coral Springs USA Florida 117549
```

2 Revising the Select Query II

Query the NAME field for all American cities in the CITY table with populations larger than 120000. The CountryCode for America is USA.

```SQL
SELECT NAME
FROM CITY
WHERE CountryCode ='USA'
AND Population>120000;
```
```HTML
Scottsdale
Corona
Concord
Cedar Rapids
```

3 Select All

Query all columns (attributes) for every row in the CITY table.

```SQL
SELECT *
FROM city;
```
```HTML
6 Rotterdam NLD Zuid-Holland 593321
3878 Scottsdale USA Arizona 202705
3965 Corona USA California 124966
3973 Concord USA California 121780
3977 Cedar Rapids USA Iowa 120758
```

4 Select By ID

Query all columns for a city in CITY with the ID 1661.


```SQL
SELECT *
FROM city
WHERE id=1661;
```
```HTML
1661 Sayama JPN Saitama 162472
```

5 Japanese Cities' Names

Query the names of all the Japanese cities in the CITY table. The COUNTRYCODE for Japan is JPN.

```SQL
SELECT NAME
FROM CITY
WHERE CountryCode ='JPN';
```
```HTML
Neyagawa
Ageo
Sayama
Omuta
Tokuyama
```

------------------------------------------

**STATION**

Field|Type
---|---
ID|NUMBER
CITY|VARCHAR2(21)
STATE|VARCHAR2(2)
LAT_N|NUMBER
LONG_W|NUMBER

where LAT_N is the northern latitude and LONG_W is the western longitude.


6 Weather Observation Station 1

Query a list of CITY and STATE from the STATION table.

```SQL
SELECT city, state
FROM station;
```
```HTML
Acme LA
Addison MI
Agency MO
Aguanga CA
Alanson MI{-truncated-}
```

7 Weather Observation Station 3

Query a list of CITY names from STATION for cities that have an even ID number. Print the results in any order, but exclude duplicates from the answer.

```SQL
SELECT DISTINCT(city)
FROM station
WHERE MOD(id,2)=0;
```
```HTML
Aguanga
Alba
Albany
Amo
Andersonville {-truncated-}
```

8 Weather Observation Station 4

Find the difference between the total number of CITY entries in the table and the number of distinct CITY entries in the table.

```SQL
SELECT COUNT(city)-COUNT(DISTINCT(city))
FROM station;
```
```HTML
13
```

9 Weather Observation Station 5

Query the two cities in STATION with the shortest and longest CITY names, as well as their respective lengths (i.e.: number of characters in the name). If there is more than one smallest or largest city, choose the one that comes first when ordered alphabetically.

```SQL
WITH Longest AS (SELECT CITY, LENGTH(CITY) AS Lengths FROM STATION
                ORDER BY Lengths desc, City LIMIT 1),
     Shortest AS (SELECT CITY, LENGTH(CITY) AS Lengths FROM STATION
                ORDER BY Lengths, City LIMIT 1)
SELECT CITY, Lengths FROM Shortest
UNION
SELECT CITY, Lengths FROM Longest;
```
```HTML
Amo 3
Marine On Saint Croix 21
```

10 Weather Observation Station 6

Query the list of CITY names starting with vowels (i.e., a, e, i, o, or u) from STATION. Your result cannot contain duplicates.

**SUBSTR: Extract a substring from a string (start at position 5, extract 3 characters)

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, 1, 1) IN ('A', 'E' , 'I', 'O', 'U');
```

```HTML
Acme
Addison
Agency{-truncated-}
```

11 Weather Observation Station 7

Query the list of CITY names ending with vowels (a, e, i, o, u) from STATION. Your result cannot contain duplicates.

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, -1) IN ('A', 'E' , 'I', 'O', 'U');
```
```HTML
Acme
Aguanga
Alba
Aliso Viejo
Alpine
Amazonia{-truncated-}
```

12 Weather Observation Station 8

Query the list of CITY names from STATION which have vowels (i.e., a, e, i, o, and u) as both their first and last characters. Your result cannot contain duplicates.

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, 1, 1) IN ('A', 'E' , 'I', 'O', 'U')
AND SUBSTR(city, -1) IN ('A', 'E' , 'I', 'O', 'U');
```
```HTML
Acme
Aguanga
Alba
Aliso Viejo
Alpine{-truncated-}
```

13 Weather Observation Station 9

Query the list of CITY names from STATION that do not start with vowels. Your result cannot contain duplicates.

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, 1, 1) NOT IN ('A', 'E' , 'I', 'O', 'U');
```
```HTML
Baileyville
Bainbridge
Baker
Baldwin{-truncated-}
```

14 Weather Observation Station 10

Query the list of CITY names from STATION that do not end with vowels. Your result cannot contain duplicates.

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, -1) NOT IN ('A', 'E' , 'I', 'O', 'U');
```
```HTML
Addison
Agency
Alanson
Albany{-truncated-}
```

15 Weather Observation Station 11

Query the list of CITY names from STATION that either do not start with vowels or do not end with vowels. Your result cannot contain duplicates.

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, 1, 1) NOT IN ('A', 'E' , 'I', 'O', 'U')
OR SUBSTR(city, -1) NOT IN ('A', 'E' , 'I', 'O', 'U');
```
```HTML
Addison
Agency
Alanson
Albany{-truncated-}
```

16 Weather Observation Station 12

Query the list of CITY names from STATION that do not start with vowels and do not end with vowels. Your result cannot contain duplicates.

```SQL
SELECT DISTINCT city
FROM station
WHERE SUBSTR(city, 1, 1) NOT IN ('A', 'E' , 'I', 'O', 'U')
AND SUBSTR(city, -1) NOT IN ('A', 'E' , 'I', 'O', 'U');
```
```HTML
Baker
Baldwin
Bass Harbor
Beaufort{-truncated-}
```

------------------------------------------

**Employee**

Column|Type
---|---
EMPLOYEE_ID|INTEGER
NAME|STRING
MONTHS|INTEGER
SALARY|INTEGER


where employee_id is an employee's ID number, name is their name, months is the total number of months they've been working for the company, and salary is their monthly salary.

17 Employee Names

Write a query that prints a list of employee names (i.e.: the name attribute) from the Employee table in alphabetical order.

```SQL
SELECT NAME
FROM Employee
ORDER BY NAME ASC;
```
```HTML
Alan
Amy
Andrew
Andrew
Angela{-truncated-}
```

18 Employee Salaries

Write a query that prints a list of employee names (i.e.: the name attribute) for employees in Employee having a salary greater than 2000 per month who have been employees for less than 10 months. Sort your result by ascending employee_id.

```SQL
SELECT NAME
FROM Employee
WHERE SALARY > 2000 AND MONTHS < 10
ORDER BY EMPLOYEE_ID ASC;
```
```HTML
Rose
Patrick
Lisa
Amy
Pamela{-truncated-}
```

------------------------------------------

**TRIANGLES**

Column|Type
---|---
A|INTEGER
B|INTEGER
C|INTEGER

19 Type of Triangle

Write a query identifying the type of each record in the TRIANGLES table using its three side lengths. Output one of the following statements for each record in the table:

Equilateral: It's a triangle with 3 sides of equal length.

Isosceles: It's a triangle with 2 sides of equal length.

Scalene: It's a triangle with 3 sides of differing lengths.

Not A Triangle: The given values of A, B, and C don't form a triangle.

```SQL
SELECT
    CASE
        WHEN A + B <= C OR A + C <= B OR B + C <= A THEN 'Not A Triangle'
        WHEN A = B AND B = C THEN 'Equilateral'
        WHEN A = B OR A = C OR B = C THEN 'Isosceles'
        ELSE 'Scalene'
    END as TriangleType
FROM TRIANGLES;
```
```HTML
Equilateral
Equilateral
Isosceles
Equilateral
Isosceles
Equilateral
Scalene
Not A Triangle
Scalene
Scalene
Scalene
Not A Triangle
Not A Triangle
Scalene
Equilateral
```

------------------------------------------

**OCCUPATIONS**

Column|Type
---|---
NAME|STRING
OCCUPATION|STRING

Occupation will only contain one of the following values: Doctor, Professor, Singer or Actor.

20 The PADS

Query an alphabetically ordered list of all names in OCCUPATIONS, immediately followed by the first letter of each profession as a parenthetical (i.e.: enclosed in parentheses). For example: AnActorName(A), ADoctorName(D), AProfessorName(P), and ASingerName(S).

And

Query the number of ocurrences of each occupation in OCCUPATIONS. Sort the occurrences in ascending order, and output them in the following format:

```HTML
There are a total of [occupation_count] [occupation]s.
```

where [occupation_count] is the number of occurrences of an occupation in OCCUPATIONS and [occupation] is the lowercase occupation name. If more than one Occupation has the same [occupation_count], they should be ordered alphabetically.

** concat: Add two strings together

```SQL
select concat(name,'(', upper(substr(occupation,1,1)),')') as name
from OCCUPATIONS
union select concat('There are a total of',' ',count(*),' ',lower(occupation),'s.') as name
from OCCUPATIONS
group by occupation
order by name
```
```HTML
Aamina(D)
Ashley(P)
Belvet(P)
Britney(P)
Christeen(S)
Eve(A)
Jane(S)
Jennifer(A)
Jenny(S)
Julia(D)
Ketty(A)
Kristeen(S)
Maria(P)
Meera(P)
Naomi(P)
Priya(D)
Priyanka(P)
Samantha(A)
There are a total of 3 doctors.
There are a total of 4 actors. {-truncated-}
```

21 Occupations

Pivot the Occupation column in OCCUPATIONS so that each Name is sorted alphabetically and displayed underneath its corresponding Occupation. The output column headers should be Doctor, Professor, Singer, and Actor, respectively.

Note: Print NULL when there are no more names corresponding to an occupation.


```SQL
select
    min(if(occupation = 'Doctor',name,null)) as Doctor,
    min(if(occupation = 'Professor',name,null)) as Professor,
    min(if(occupation = 'Singer',name,null)) as Singer,
    min(if(occupation = 'Actor',name,null)) as Actor
from
(select name,occupation,Row_number() Over (partition by occupation order by name) as row_num from occupations) as ord group by row_num;
```
```HTML
Aamina Ashley Christeen Eve
Julia Belvet Jane Jennifer
Priya Britney Jenny Ketty
NULL Maria Kristeen Samantha
NULL Meera NULL NULL
NULL Naomi NULL NULL
NULL Priyanka NULL NULL
```

------------------------------------------

**BST**

Column|Type
---|---
N|INTEGER
P|INTEGER

You are given a table, BST, containing two columns: N and P, where N represents the value of a node in Binary Tree, and P is the parent of N.

22 Binary Tree Nodes

Write a query to find the node type of Binary Tree ordered by the value of the node. Output one of the following for each node:

Root: If node is root node.

Leaf: If node is leaf node.

Inner: If node is neither root nor leaf node.


```SQL
select N,
    case
        when P is null then 'Root'
        when N in (select distinct P from BST) then 'Inner'
        else 'Leaf'
    end
from BST
order by 1
```
```HTML
1 Leaf
2 Inner
3 Leaf
4 Inner
5 Leaf 
```





```SQL

```
```HTML

```





```SQL

```
```HTML

```





```SQL

```
```HTML

```



```SQL

```
```HTML

```





```SQL

```
```HTML

```





```SQL

```
```HTML

```





```SQL

```
```HTML

```



```SQL

```
```HTML

```





```SQL

```
```HTML

```





```SQL

```
```HTML

```





```SQL

```
```HTML

```
